#include "tegra194-cti-camera-2cam-AVT-header.dtsi"
#include "tegra194-xavier-nx-cti-AVT-modes.dtsi"
#include "tegra194-cti-camera-2cam-base.dtsi"

#define CAM1_PWDN	TEGRA194_MAIN_GPIO(P, 4)
#define CAM2_PWDN	TEGRA194_MAIN_GPIO(P, 5)
#define CAMERA_I2C_MUX_BUS(x) (0x1E + x)

/ {
	gpio@2200000 {
		camera-control-output-low {
			gpio-hog;
			output-low;
			gpios = <CAM1_PWDN 0 CAM2_PWDN 0>;
			label = "cam1-pwdn","cam2-pwdn";
		};
	};
	
	i2c@3180000 {
		tca9546@70 {
			compatible = "nxp,pca9544";
			reg = <0x70>;
			#address-cells = <1>;
			#size-cells = <0>;			
			//skip_mux_detect = "yes";
			vif-supply = <&p3509_vdd_1v8_cvb>;
			vcc-supply = <&p3509_vdd_1v8_cvb>;
			vcc_lp = "vcc";			
			
			i2c@0 {
				reg = <0>;
				i2c-mux,deselect-on-exit;
				avt_csi2_a@3c {
					clocks = <&bpmp_clks TEGRA194_CLK_EXTPERIPH1>,
							 <&bpmp_clks TEGRA194_CLK_PLLP_OUT0>;
					clock-names = "extperiph1", "pllp_grtba";
					mclk = "extperiph1";
					reset-gpios = <&tegra_main_gpio CAM1_PWDN GPIO_ACTIVE_HIGH>;
				};
			};
			
			i2c@1 {
				reg = <1>;
				i2c-mux,deselect-on-exit;
				avt_csi2_c@3c {
					clocks = <&bpmp_clks TEGRA194_CLK_EXTPERIPH1>,
							 <&bpmp_clks TEGRA194_CLK_PLLP_OUT0>;
					clock-names = "extperiph1", "pllp_grtba";
					mclk = "extperiph1";
					reset-gpios = <&tegra_main_gpio CAM2_PWDN GPIO_ACTIVE_HIGH>;
				};
			};
		};
	};
			
	tcp: tegra-camera-platform {
		compatible = "nvidia, tegra-camera-platform";

		/**
		* Physical settings to calculate max ISO BW
		*
		* num_csi_lanes = <>;
		* Total number of CSI lanes when all cameras are active
		*
		* max_lane_speed = <>;
		* Max lane speed in Kbit/s
		*
		* min_bits_per_pixel = <>;
		* Min bits per pixel
		*
		* vi_peak_byte_per_pixel = <>;
		* Max byte per pixel for the VI ISO case
		*
		* vi_bw_margin_pct = <>;
		* Vi bandwidth margin in percentage
		*
		* max_pixel_rate = <>;
		* Max pixel rate in Kpixel/s for the ISP ISO case
		*
		* isp_peak_byte_per_pixel = <>;
		* Max byte per pixel for the ISP ISO case
		*
		* isp_bw_margin_pct = <>;
		* Isp bandwidth margin in percentage
		*/
		num_csi_lanes = <4>;
		max_lane_speed = <1500000>;
		min_bits_per_pixel = <10>;
		vi_peak_byte_per_pixel = <2>;
		vi_bw_margin_pct = <25>;
		max_pixel_rate = <160000>;
		isp_peak_byte_per_pixel = <5>;
		isp_bw_margin_pct = <25>;
	};
};
